# 🎄 C 语言命令行圣诞树（局部闪烁优化版）

这是一个基于 C 语言实现的、可在终端/命令行中运行的圣诞树程序。它利用 **ANSI 颜色代码** 实现彩色输出和 **随机局部闪烁** 效果，为您带来更精细的节日问候。

## 运行效果

这是一个在命令行中运行时的效果截图。

![命令行圣诞树运行截图](https://github.com/LJZ-Anonymity/ChristmasTree/blob/main/image.png)

## ✨ 特性一览

- **彩色输出：** 使用 ANSI 颜色代码定义了树叶、树干、顶星和装饰灯的颜色。

- **精细闪烁效果 (NEW!):** 采用光标定位（`\033[y;xH`）技术，**只更新灯光的颜色或状态**，而非全局清屏重绘，实现了更稳定、更平滑的灯光闪烁动画。

- **分层结构：** 圣诞树主体由多层金字塔形状堆叠而成，营造出立体的视觉效果。

- **跨平台兼容：** 针对 Windows (`Sleep`) 和 POSIX 系统 (Linux/macOS, `usleep`) 提供了不同的延时宏定义。

- **节日祝福：** 树的底部会输出 “Merry Christmas!” 祝福语。

## 🛠️ 构建与运行

### 1. 编译

您需要一个 C 语言编译器，例如 GCC 或 Clang。

在终端中，使用以下命令编译源代码：

Bash

```bash
# 源文件名为 ChristmasTree.c
gcc ChristmasTree.c -o ChristmasTree
```

### 2. 运行

编译成功后，直接运行生成的可执行文件。

**注意：** 本程序需要一个支持 ANSI 颜色代码和光标定位操作的终端环境（现代终端通常都支持）。

Bash

```bash
# 在 Linux/macOS 上运行
./ChristmasTree

# 在 Windows 上运行 (PowerShell 或新版 CMD/Terminal)
.\ChristmasTree.exe
```

程序将启动一个无限循环，持续在终端中绘制闪烁的圣诞树。

### 停止程序

要停止程序，请在终端中按下 `Ctrl + C`。

## 💡 技术细节

### 🎨 颜色与局部闪烁 (关键更新)

程序利用了标准的 ANSI 颜色转义序列来设置文本颜色。

* **颜色定义：** 在代码的顶部定义了各种颜色宏，例如：
* `#define GREEN_LEAF "\033[32m"` (绿色树叶)
* `#define GOLD "\033[93m"` (亮黄色/金色)

* **闪烁机制：**
1. **第一次绘制 (`draw_tree_frame_initial`):** 完整绘制圣诞树，并在绘制过程中，记录下所有随机生成的灯光在终端中的 ** 坐标和颜色索引**。
2. **动画循环 (`flash_tree_lights`):** 在 `while(1)` 循环中，程序不再使用清屏 (`\033[H`) 重绘整个树，而是循环遍历所有已记录的灯光位置。
3. **光标定位与更新:** 使用 ANSI 序列 **`\033[y;xH`** 精确移动光标到每个灯光的位置，然后交替打印彩色灯光 (`*`) 和绿色树叶 (`*`)，实现了灯光“点亮”和“熄灭”的闪烁效果，极大地减少了屏幕绘制量。

### 🌲 树的结构

圣诞树主体由 `draw_layer` 函数绘制的分层结构组成：

| **部分**  | **draw_layer 参数 (宽度, 行数, 偏移)** | **描述**         |
| ------- | ------------------------------ | -------------- |
| **顶星**  | N/A                            | Unicode 符号 `★` |
| **尖顶**  | `(1, 1, 0)`                    | 单行尖顶           |
| **第一层** | `(7, 3, 0)`                    | 基础层，尖顶         |
| **第二层** | `(13, 4, 1)`                   | 平顶层，增加宽度       |
| **第三层** | `(21, 5, 1)`                   | 最宽层，平顶         |
| **树干**  | N/A                            | 三行 `***`，使用深棕色 |

## 🌟 感谢

感谢您使用这个项目，祝您节日快乐！

```
   Merry Christmas!
```
